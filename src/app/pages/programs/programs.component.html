<p-toast position="top-right"></p-toast>
<div class="container ui-g">
  <p-sidebar [(visible)]="sidebar" styleClass="ui-sidebar-lg">
    <!-- <p-blockUI [blocked]="loading" [target]="cnter">
                <p-progressSpinner></p-progressSpinner>
        </p-blockUI> -->
    <div class="programs-add-programs">
      <app-add-program
        [programs]="selectablePrograms"
        (nextStep)="goToNextStep($event)"
      ></app-add-program>
    </div>
  </p-sidebar>
  <div class="menu ui-md-1">
    <button
      type="text"
      (click)="sidebar = true"
      pButton
      icon="pi pi-plus"
      label="Add"
    ></button>
  </div>
  <div
    class="programs-listing"
    [ngClass]="{ 'ui-md-offset-6 ui-md-6': sidebar, 'ui-md-11': !sidebar }"
  >
    <p-table [value]="programs" [dataKey]="'data.attributes.title'">
      <ng-template pTemplate="header">
        <tr>
          <th></th>
          <th>Name</th>
          <th>Address</th>
          <th>Genres</th>
          <th>Type</th>
          <th>Application Deadline</th>
          <th>Application Fee</th>
          <th>Actions</th>
        </tr>
      </ng-template>
      <ng-template pTemplate="body" let-programData let-program let-expanded="expanded">
        <tr class="program-row">
            <td>
                <div [pRowToggler]="programData">
                    <i [ngClass]="expanded ? 'pi pi-chevron-down' : 'pi pi-chevron-right'"></i>
                </div>
          </td>
          <td class="ui-p-2">{{ program.data.attributes.title }}</td>
          <td class="ui-p-2">{{ program.data.attributes.field_address }}</td>
          <td class="ui-p-2">{{ program.genres | join: ", " }}</td>
          <td class="ui-p-2">{{ program.residency_type | join: ", " }}</td>
          <td class="ui-p-2">{{ program.data.attributes.field_application_deadline}}</td>
          <td class="ui-p-2">${{ program.data.attributes.field_fee}}</td>
          <td class="ui-p-2">
            <div class="remove-button" (click)="removeProgram(program)">
              <i class="pi pi-times" style="font-size: 3em"></i>
            </div>
          </td>
        </tr>
      </ng-template>
      <ng-template pTemplate="rowexpansion" let-programData>
            <tr>
                <td [attr.colspan]="8">
                    <img src="{{ programData.logo }}" alt="">
                    <div class="ui-p-2">{{ programData.data.attributes.title }}</div>
                </td>
            </tr>
        </ng-template>
    </p-table>
  </div>
</div>
